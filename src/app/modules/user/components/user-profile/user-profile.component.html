<app-tabbed-profile-base
  [userProfile]="userProfile"
  [isEditable]="true"
  [isOwner]="true"
  [topFiveAlbums]="topFiveAlbums"
  [hasErasTour]="hasErasTour"
  [themeBackground]="getThemeBackground()"
  (editImage)="openProfileImageDialog()"
  (questionUpdated)="onQuestionUpdated($event)"
  (saveAnswers)="onSaveAnswers()"
>
  <!-- Profile-specific controls -->
  <div slot="profile-controls" class="user-profile-controls">
    <!-- Country Selector -->
    <div class="country-selector">
      <label for="country">Your country:</label>
      <select
        id="country"
        [ngModel]="userProfile.country || ''"
        (ngModelChange)="onCountryChange($event)"
      >
        <option value="">Select your country</option>
        <option *ngFor="let country of countries" [value]="country">
          {{ country }}
        </option>
      </select>
    </div>

    <!-- Theme Selector -->
    <div class="theme-selector">
      <label for="theme">Choose your profile theme:</label>
      <select
        id="theme"
        [ngModel]="userProfile.theme || defaultTheme"
        (ngModelChange)="updateTheme($event)"
      >
        <option *ngFor="let theme of themes" [value]="theme">
          {{ theme }}
        </option>
      </select>
    </div>
  </div>

</app-tabbed-profile-base>

<!-- Profile Image Selection Dialog -->
<div
  *ngIf="showProfileImageDialog"
  class="profile-image-dialog-overlay"
  (click)="closeProfileImageDialog()"
>
  <div class="profile-image-dialog" (click)="$event.stopPropagation()">
    <h2>Choose a Profile Image</h2>
    <div class="image-grid">
      <img
        *ngFor="let image of profileImages"
        [src]="image"
        (click)="selectProfileImage(image)"
        class="image-option"
        alt="Profile option"
      />
    </div>
    <button (click)="closeProfileImageDialog()" class="close-button">
      Cancel
    </button>
  </div>
</div>