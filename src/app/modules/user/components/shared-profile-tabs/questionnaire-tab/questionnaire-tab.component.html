<section class="questionnaire" [ngClass]="getThemeClass()">
  <div class="btn-container">
    <h2>Swiftie Questionnaire</h2>
    <!-- Only show edit/save buttons if user is the owner -->
    <div *ngIf="isEditable && isOwner">
      <button
        *ngIf="!isEditing"
        (click)="startEditing()"
        class="edit-button"
      >
        Edit Answers
      </button>
      <button
        *ngIf="isEditing"
        (click)="onSaveAnswers()"
        class="save-button"
      >
        Save Answers
      </button>
    </div>
  </div>

  <!-- Show message when no questions are answered (for public profiles only) -->
  <div *ngIf="!isOwner && !hasAnyAnswers()" class="no-answers-message">
    <div class="empty-state">
      <div class="empty-icon">üìù</div>
      <h3>No Questionnaire Answers Yet</h3>
      <p>{{ userProfile?.username || 'This user' }} hasn't filled out their Swiftie questionnaire yet.</p>
      <p class="subtle-text">Check back later to see their answers!</p>
    </div>
  </div>

  <!-- Show message when no questions are answered (for profile owners) -->
  <div *ngIf="isOwner && !hasAnyAnswers() && !isEditing" class="no-answers-message owner">
    <div class="empty-state">
      <div class="empty-icon">‚ú®</div>
      <h3>Share Your Swiftie Story!</h3>
      <p>Let other Swifties get to know you by answering these fun questions.</p>
      <button
        (click)="startEditing()"
        class="get-started-button"
      >
        Get Started
      </button>
    </div>
  </div>
  
  <!-- Show questions list when there are answers OR when editing -->
  <div *ngIf="hasAnyAnswers() || (isOwner && isEditing)" class="question-list">
    <div
      *ngFor="let questionObj of profileQuestions; let i = index"
      class="question-item"
    >
      <p class="question">{{ questionObj.question }}</p>
      
      <!-- Show editable div when editing -->
      <div
        *ngIf="isEditing && isEditable && isOwner"
        class="answer editable"
        [contentEditable]="true"
        (blur)="updateQuestionAnswer(i, $event)"
        [innerHTML]="sanitizeInput(questionObj.answer)"
      ></div>
      
      <!-- Show read-only content when not editing -->
      <div
        *ngIf="!(isEditing && isEditable && isOwner)"
        class="answer readonly"
      >
        <!-- Show answer if it exists and is not empty -->
        <span 
          *ngIf="hasAnswer(questionObj.answer)" 
          [innerHTML]="sanitizeInput(questionObj.answer)"
        ></span>
        
        <!-- Show unanswered message if no answer -->
        <span 
          *ngIf="!hasAnswer(questionObj.answer)" 
          class="unanswered-text"
        >
          {{ getUnansweredText() }}
        </span>
      </div>
    </div>
  </div>
</section>